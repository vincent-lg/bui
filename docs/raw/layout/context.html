<!DOCTYPE html>
<html lang="en-US">
  <head>
   <meta charset="UTF-8">
    <title>Blind User Interface - layout/context.py</title>
    <meta name="generator" content="Jekyll v3.8.5" />
    <meta property="og:title" content="layout/context.py" />
    <meta property="og:locale" content="en_US" />
    <meta name="description" content="layout/context.py" />
    <meta property="og:description" content="layout/context.py" />
    <link rel="canonical" href="https://vincent-lg.github.io/bui/layout/context.html" />
    <meta property="og:url" content="https://vincent-lg.github.io/bui/layout/context.html" />
    <meta property="og:site_name" content="bui" />
    <script type="application/ld+json">
    {"@type":"WebSite","headline":"Blind User Interface - layout/context.py","url":"https://vincent-lg.github.io/bui/layout/context.html","name":"layout/context.py","description":"layout/context.py","@context":"http://schema.org"}</script>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="theme-color" content="#157878">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <link rel="stylesheet" href="/bui/assets/css/style.css?v=1c99addae22d0f201ec863ee092d1195efd935b8">
  </head>
  <body>
    <div>
      <span style="white-space: pre;"><a id="L1"></a>&quot;&quot;&quot;Context menu object represented in layout.&quot;&quot;&quot;</span><br />
      <span style="white-space: pre;"><a id="L2"></a></span><br />
      <span style="white-space: pre;"><a id="L3"></a>from bui.layout.attr import Attr</span><br />
      <span style="white-space: pre;"><a id="L4"></a>from bui.layout.component import Component</span><br />
      <span style="white-space: pre;"><a id="L5"></a></span><br />
      <span style="white-space: pre;"><a id="L6"></a>class Context(Component):</span><br />
      <span style="white-space: pre;"><a id="L7"></a></span><br />
      <span style="white-space: pre;"><a id="L8"></a>    &quot;&quot;&quot;</span><br />
      <span style="white-space: pre;"><a id="L9"></a>    Create a context menu, a popup menu.</span><br />
      <span style="white-space: pre;"><a id="L10"></a></span><br />
      <span style="white-space: pre;"><a id="L11"></a>    A context menu is a menu that will pop up, usually in response to</span><br />
      <span style="white-space: pre;"><a id="L12"></a>    a right click (hence the name), though context menus can be</span><br />
      <span style="white-space: pre;"><a id="L13"></a>    more generic than that.  They can be used for pop-up menus</span><br />
      <span style="white-space: pre;"><a id="L14"></a>    (appear when the user presses a button, for instance).</span><br />
      <span style="white-space: pre;"><a id="L15"></a></span><br />
      <span style="white-space: pre;"><a id="L16"></a>    ```</span><br />
      <span style="white-space: pre;"><a id="L17"></a>    &lt;context id=right&gt;</span><br />
      <span style="white-space: pre;"><a id="L18"></a>      ...</span><br />
      <span style="white-space: pre;"><a id="L19"></a>    &lt;/context&gt;</span><br />
      <span style="white-space: pre;"><a id="L20"></a>    ```</span><br />
      <span style="white-space: pre;"><a id="L21"></a></span><br />
      <span style="white-space: pre;"><a id="L22"></a>    ## Usage</span><br />
      <span style="white-space: pre;"><a id="L23"></a></span><br />
      <span style="white-space: pre;"><a id="L24"></a>    Like [dialogs](dialog.md), context menus are generated dynamically</span><br />
      <span style="white-space: pre;"><a id="L25"></a>    in response to a control.  It is, however, necessary to</span><br />
      <span style="white-space: pre;"><a id="L26"></a>    register them in the window layout, even though they don&#x27;t</span><br />
      <span style="white-space: pre;"><a id="L27"></a>    &quot;appear&quot; on the screen before they&#x27;re actually popped up.</span><br />
      <span style="white-space: pre;"><a id="L28"></a></span><br />
      <span style="white-space: pre;"><a id="L29"></a>    ### Register a context menu</span><br />
      <span style="white-space: pre;"><a id="L30"></a></span><br />
      <span style="white-space: pre;"><a id="L31"></a>    To register a context menu, use the `&lt;context&gt;` tag as</span><br />
      <span style="white-space: pre;"><a id="L32"></a>    a direct child of a window.</span><br />
      <span style="white-space: pre;"><a id="L33"></a></span><br />
      <span style="white-space: pre;"><a id="L34"></a>    ```</span><br />
      <span style="white-space: pre;"><a id="L35"></a>    &lt;window title=&quot;Show context menu usage&quot;&gt;</span><br />
      <span style="white-space: pre;"><a id="L36"></a>      &lt;!-- A menu bar perhaps here --&gt;</span><br />
      <span style="white-space: pre;"><a id="L37"></a>      &lt;context id=right&gt;</span><br />
      <span style="white-space: pre;"><a id="L38"></a>        &lt;item&gt;Cut&lt;/item&gt;</span><br />
      <span style="white-space: pre;"><a id="L39"></a>        &lt;item&gt;Copy&lt;/item&gt;</span><br />
      <span style="white-space: pre;"><a id="L40"></a>        &lt;item&gt;Paste&lt;/item&gt;</span><br />
      <span style="white-space: pre;"><a id="L41"></a>        &lt;menu name=&quot;Paste Special&quot;&gt;</span><br />
      <span style="white-space: pre;"><a id="L42"></a>          &lt;item&gt;Mix...&lt;/item&gt;</span><br />
      <span style="white-space: pre;"><a id="L43"></a>          &lt;item&gt;Merge...&lt;/item&gt;</span><br />
      <span style="white-space: pre;"><a id="L44"></a>        &lt;/menu&gt;</span><br />
      <span style="white-space: pre;"><a id="L45"></a>        &lt;item&gt;Property...&lt;/item&gt;</span><br />
      <span style="white-space: pre;"><a id="L46"></a>      &lt;/context&gt;</span><br />
      <span style="white-space: pre;"><a id="L47"></a></span><br />
      <span style="white-space: pre;"><a id="L48"></a>      &lt;!-- The window grid... --&gt;</span><br />
      <span style="white-space: pre;"><a id="L49"></a>    &lt;/window&gt;</span><br />
      <span style="white-space: pre;"><a id="L50"></a>    ```</span><br />
      <span style="white-space: pre;"><a id="L51"></a></span><br />
      <span style="white-space: pre;"><a id="L52"></a>    To register a context menu, we place a `&lt;context&gt;` tag as</span><br />
      <span style="white-space: pre;"><a id="L53"></a>    a direct child of the [window](window.md) tag.  We give it</span><br />
      <span style="white-space: pre;"><a id="L54"></a>    a mandatory identifier (ID).  Inside of the context tag, we use</span><br />
      <span style="white-space: pre;"><a id="L55"></a>    [items](item.md) to represent choices and [menus](.menu.md)</span><br />
      <span style="white-space: pre;"><a id="L56"></a>    to represent sub-menus.</span><br />
      <span style="white-space: pre;"><a id="L57"></a></span><br />
      <span style="white-space: pre;"><a id="L58"></a>    Defining a context menu in layout will not pop anything on</span><br />
      <span style="white-space: pre;"><a id="L59"></a>    the screen.  This is just a way to register the menu, but you&#x27;ll</span><br />
      <span style="white-space: pre;"><a id="L60"></a>    have to pop it.</span><br />
      <span style="white-space: pre;"><a id="L61"></a></span><br />
      <span style="white-space: pre;"><a id="L62"></a>    ### Pop it up</span><br />
      <span style="white-space: pre;"><a id="L63"></a></span><br />
      <span style="white-space: pre;"><a id="L64"></a>    After a menu has been registered and assigned an ID, you can easily</span><br />
      <span style="white-space: pre;"><a id="L65"></a>    pop it in response to a user action, in control methods:</span><br />
      <span style="white-space: pre;"><a id="L66"></a></span><br />
      <span style="white-space: pre;"><a id="L67"></a>    ```python</span><br />
      <span style="white-space: pre;"><a id="L68"></a>    class TestContextMenu(Window):</span><br />
      <span style="white-space: pre;"><a id="L69"></a></span><br />
      <span style="white-space: pre;"><a id="L70"></a>        layout = mark(\&quot;\&quot;\&quot;</span><br />
      <span style="white-space: pre;"><a id="L71"></a>           # Insert the layout in the previous section...</span><br />
      <span style="white-space: pre;"><a id="L72"></a>       \&quot;\&quot;\&quot;)</span><br />
      <span style="white-space: pre;"><a id="L73"></a></span><br />
      <span style="white-space: pre;"><a id="L74"></a>        def on_right_click(self):</span><br />
      <span style="white-space: pre;"><a id="L75"></a>            \&quot;\&quot;\&quot;The user has right clicked anywhere on the window.\&quot;\&quot;\&quot;</span><br />
      <span style="white-space: pre;"><a id="L76"></a>            # We use the context menu&#x27;s identifier (&quot;right&quot;)</span><br />
      <span style="white-space: pre;"><a id="L77"></a>            self.pop_menu(&quot;right&quot;)</span><br />
      <span style="white-space: pre;"><a id="L78"></a>    ```</span><br />
      <span style="white-space: pre;"><a id="L79"></a></span><br />
      <span style="white-space: pre;"><a id="L80"></a>    And that&#x27;s it.  The call to `pop_menu` will block until the</span><br />
      <span style="white-space: pre;"><a id="L81"></a>    user selects a choice.  When that&#x27;s done, a control is fired and</span><br />
      <span style="white-space: pre;"><a id="L82"></a>    the menu closes.</span><br />
      <span style="white-space: pre;"><a id="L83"></a></span><br />
      <span style="white-space: pre;"><a id="L84"></a>    &gt; How to intercept controls in this situation?</span><br />
      <span style="white-space: pre;"><a id="L85"></a></span><br />
      <span style="white-space: pre;"><a id="L86"></a>    You will have defined control methods to intercept these choices.</span><br />
      <span style="white-space: pre;"><a id="L87"></a>    The following section offers a complete example:</span><br />
      <span style="white-space: pre;"><a id="L88"></a></span><br />
      <span style="white-space: pre;"><a id="L89"></a>    ### Control methods and context menus</span><br />
      <span style="white-space: pre;"><a id="L90"></a></span><br />
      <span style="white-space: pre;"><a id="L91"></a>    We take the same example as previously and intercept the user</span><br />
      <span style="white-space: pre;"><a id="L92"></a>    clicking on &quot;Cut&quot; and &quot;Copy&quot;.</span><br />
      <span style="white-space: pre;"><a id="L93"></a></span><br />
      <span style="white-space: pre;"><a id="L94"></a>    ```python</span><br />
      <span style="white-space: pre;"><a id="L95"></a>    class TestContextMenu(Window):</span><br />
      <span style="white-space: pre;"><a id="L96"></a></span><br />
      <span style="white-space: pre;"><a id="L97"></a>        layout = mark(\&quot;\&quot;\&quot;</span><br />
      <span style="white-space: pre;"><a id="L98"></a>            &lt;window title=&quot;Show context menu usage&quot;&gt;</span><br />
      <span style="white-space: pre;"><a id="L99"></a>              &lt;!-- A menu bar perhaps here --&gt;</span><br />
      <span style="white-space: pre;"><a id="L100"></a>              &lt;context id=right&gt;</span><br />
      <span style="white-space: pre;"><a id="L101"></a>                &lt;item&gt;Cut&lt;/item&gt;</span><br />
      <span style="white-space: pre;"><a id="L102"></a>                &lt;item id=ctx_copy&gt;Copy&lt;/item&gt;</span><br />
      <span style="white-space: pre;"><a id="L103"></a>                &lt;item&gt;Paste&lt;/item&gt;</span><br />
      <span style="white-space: pre;"><a id="L104"></a>                &lt;menu name=&quot;Paste Special&quot;&gt;</span><br />
      <span style="white-space: pre;"><a id="L105"></a>                  &lt;item&gt;Mix...&lt;/item&gt;</span><br />
      <span style="white-space: pre;"><a id="L106"></a>                  &lt;item&gt;Merge...&lt;/item&gt;</span><br />
      <span style="white-space: pre;"><a id="L107"></a>                &lt;/menu&gt;</span><br />
      <span style="white-space: pre;"><a id="L108"></a>                &lt;item&gt;Property...&lt;/item&gt;</span><br />
      <span style="white-space: pre;"><a id="L109"></a>              &lt;/context&gt;</span><br />
      <span style="white-space: pre;"><a id="L110"></a></span><br />
      <span style="white-space: pre;"><a id="L111"></a>              &lt;!-- The window grid... --&gt;</span><br />
      <span style="white-space: pre;"><a id="L112"></a>              &lt;text x=2 y=2 width=3 id=result read-only&gt;Result&lt;/text&gt;</span><br />
      <span style="white-space: pre;"><a id="L113"></a>            &lt;/window&gt;</span><br />
      <span style="white-space: pre;"><a id="L114"></a>        \&quot;\&quot;\&quot;)</span><br />
      <span style="white-space: pre;"><a id="L115"></a></span><br />
      <span style="white-space: pre;"><a id="L116"></a>        def on_right_click(self):</span><br />
      <span style="white-space: pre;"><a id="L117"></a>            \&quot;\&quot;\&quot;The user has right clicked anywhere on the window.\&quot;\&quot;\&quot;</span><br />
      <span style="white-space: pre;"><a id="L118"></a>            self.pop_menu(&quot;right&quot;)</span><br />
      <span style="white-space: pre;"><a id="L119"></a></span><br />
      <span style="white-space: pre;"><a id="L120"></a>        def on_cut(self):</span><br />
      <span style="white-space: pre;"><a id="L121"></a>            \&quot;\&quot;\&quot;The user has chosen &quot;cut&quot; in the context menu.\&quot;\&quot;\&quot;</span><br />
      <span style="white-space: pre;"><a id="L122"></a>            self[&quot;result&quot;].value = &quot;The user chose to Cut!&quot;</span><br />
      <span style="white-space: pre;"><a id="L123"></a></span><br />
      <span style="white-space: pre;"><a id="L124"></a>        def on_ctx_copy(self):</span><br />
      <span style="white-space: pre;"><a id="L125"></a>            \&quot;\&quot;\&quot;The user has clicked on the &quot;copy&quot; menu item.</span><br />
      <span style="white-space: pre;"><a id="L126"></a>            (Note that this menu has a specific ID).</span><br />
      <span style="white-space: pre;"><a id="L127"></a>            \&quot;\&quot;\&quot;</span><br />
      <span style="white-space: pre;"><a id="L128"></a>            self[&quot;result&quot;].value = &quot;The user chose to Copy!&quot;</span><br />
      <span style="white-space: pre;"><a id="L129"></a>    ```</span><br />
      <span style="white-space: pre;"><a id="L130"></a></span><br />
      <span style="white-space: pre;"><a id="L131"></a>    It works because the context menu was registered beforehand and</span><br />
      <span style="white-space: pre;"><a id="L132"></a>    control methods were successfully connected to menu items.  Notice</span><br />
      <span style="white-space: pre;"><a id="L133"></a>    that the</span><br />
      <span style="white-space: pre;"><a id="L134"></a>    [note about identifiers in items](item.md#note-about-identifiers)</span><br />
      <span style="white-space: pre;"><a id="L135"></a>    also applies to items inside context menus: you might need to give</span><br />
      <span style="white-space: pre;"><a id="L136"></a>    them explicit IDs (like we did for the &quot;Copy&quot; item in the</span><br />
      <span style="white-space: pre;"><a id="L137"></a>    previous example) and adapt your control methods accordingly.</span><br />
      <span style="white-space: pre;"><a id="L138"></a></span><br />
      <span style="white-space: pre;"><a id="L139"></a>    ## Attributes</span><br />
      <span style="white-space: pre;"><a id="L140"></a></span><br />
      <span style="white-space: pre;"><a id="L141"></a>    | Name         | Required | Description              | Example     |</span><br />
      <span style="white-space: pre;"><a id="L142"></a>    | ------------ | -------- | ------------------------ | ----------- |</span><br />
      <span style="white-space: pre;"><a id="L143"></a>    | `id`         | Yes      | The context menu         | `&lt;context   |</span><br />
      <span style="white-space: pre;"><a id="L144"></a>    |              |          | identifier (ID).         | id=right&gt;`  |</span><br />
      <span style="white-space: pre;"><a id="L145"></a>    |              |          | Contrary to other        |             |</span><br />
      <span style="white-space: pre;"><a id="L146"></a>    |              |          | widgets, an identifier   |             |</span><br />
      <span style="white-space: pre;"><a id="L147"></a>    |              |          | is absolutely required,  |             |</span><br />
      <span style="white-space: pre;"><a id="L148"></a>    |              |          | otherwise you won&#x27;t be   |             |</span><br />
      <span style="white-space: pre;"><a id="L149"></a>    |              |          | able to pop this context |             |</span><br />
      <span style="white-space: pre;"><a id="L150"></a>    |              |          | menu in a control        |             |</span><br />
      <span style="white-space: pre;"><a id="L151"></a>    |              |          | method.                  |             |</span><br />
      <span style="white-space: pre;"><a id="L152"></a></span><br />
      <span style="white-space: pre;"><a id="L153"></a>    &gt; `id` is the only mandatory attribute.</span><br />
      <span style="white-space: pre;"><a id="L154"></a></span><br />
      <span style="white-space: pre;"><a id="L155"></a>    ## Data</span><br />
      <span style="white-space: pre;"><a id="L156"></a></span><br />
      <span style="white-space: pre;"><a id="L157"></a>    This tag will be turned into a [Context widget](../../widget/Context.md).</span><br />
      <span style="white-space: pre;"><a id="L158"></a></span><br />
      <span style="white-space: pre;"><a id="L159"></a>    | Attribute      | Meaning and type | Example                     |</span><br />
      <span style="white-space: pre;"><a id="L160"></a>    | -------------- | ---------------- | --------------------------- |</span><br />
      <span style="white-space: pre;"><a id="L161"></a>    | `id`           | The ID (str).    | `cid = self.id`             |</span><br />
      <span style="white-space: pre;"><a id="L162"></a>    |                | This attribute   |                             |</span><br />
      <span style="white-space: pre;"><a id="L163"></a>    |                | cannot be        |                             |</span><br />
      <span style="white-space: pre;"><a id="L164"></a>    |                | changed.         |                             |</span><br />
      <span style="white-space: pre;"><a id="L165"></a></span><br />
      <span style="white-space: pre;"><a id="L166"></a>    ## Controls</span><br />
      <span style="white-space: pre;"><a id="L167"></a></span><br />
      <span style="white-space: pre;"><a id="L168"></a>    This widget has no control.  Use the controls on</span><br />
      <span style="white-space: pre;"><a id="L169"></a>    [menu items](item.md#controls) instead.</span><br />
      <span style="white-space: pre;"><a id="L170"></a></span><br />
      <span style="white-space: pre;"><a id="L171"></a>    &quot;&quot;&quot;</span><br />
      <span style="white-space: pre;"><a id="L172"></a></span><br />
      <span style="white-space: pre;"><a id="L173"></a>    tag_name = &quot;context&quot;</span><br />
      <span style="white-space: pre;"><a id="L174"></a>    attrs = (</span><br />
      <span style="white-space: pre;"><a id="L175"></a>        Attr(&quot;id&quot;, help=&quot;The widget identifier&quot;),</span><br />
      <span style="white-space: pre;"><a id="L176"></a>    )</span><br />
      <span style="white-space: pre;"><a id="L177"></a></span><br />
      <span style="white-space: pre;"><a id="L178"></a>    def __init__(self, layout, parent, id):</span><br />
      <span style="white-space: pre;"><a id="L179"></a>        super().__init__(layout, parent)</span><br />
      <span style="white-space: pre;"><a id="L180"></a>        self.id = id</span><br />
    </div>
  </body>
</html>